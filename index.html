<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>â¤ï¸ Complaint Portal</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
body{
  font-family: Arial;
  background: linear-gradient(135deg,#ffd6e8,#ffeccf);
  text-align:center;
  padding:20px;
}
.card{
  background:white;
  padding:20px;
  border-radius:20px;
  max-width:420px;
  margin:auto;
  box-shadow:0 10px 25px rgba(0,0,0,0.15);
}
button{
  background:#ff4d8d;
  color:white;
  border:none;
  padding:10px 15px;
  border-radius:10px;
  margin-top:10px;
  cursor:pointer;
}
select,textarea,input{
  width:100%;
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
}
.heart{
  position:fixed;
  font-size:24px;
  animation:floatUp 2s ease forwards;
}
@keyframes floatUp{
  from{transform:translateY(0);opacity:1}
  to{transform:translateY(-200px);opacity:0}
}
</style>
</head>
<body>

<div class="card" id="loginCard">
<h2>ğŸ’Œ Private Portal</h2>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button onclick="login()">Login â¤ï¸</button>
</div>

<div class="card" id="app" style="display:none">
<h2>Complaint Portal</h2>

<div id="girlfriendPanel" style="display:none">
<h3>Submit Complaint ğŸ¥º</h3>

<select id="category">
<option>Late reply</option>
<option>Not enough hugs</option>
<option>Made me miss him</option>
<option>Jealous mode</option>
<option>Other</option>
</select>

<textarea id="complaint" placeholder="Describe..."></textarea>
<button onclick="submitComplaint()">Submit</button>
</div>

<div id="boyfriendPanel" style="display:none">
<h3>Admin Dashboard ğŸ˜</h3>
<div id="complaints"></div>

<h3>Hugs Given ğŸ¤—: <span id="hugCount">0</span></h3>
<button onclick="giveHug()">Give Hug â¤ï¸</button>

<h3>Voice Note Reply ğŸ™</h3>
<input type="file" id="voiceUpload" accept="audio/*">
<button onclick="uploadVoice()">Send Voice Reply</button>
</div>

<h3>Status</h3>
<div id="status"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDCW6Jeoj0jgo8ncpUm0og6B_y0j5wLx0o",
  authDomain: "bear-s-complaintportal.firebaseapp.com",
  projectId: "bear-s-complaintportal",
  storageBucket: "bear-s-complaintportal.firebasestorage.app",
  messagingSenderId: "474005402279",
  appId: "1:474005402279:web:3bb80e63a65a6332e26182",
  measurementId: "G-R125N17T0M"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const boyfriendEmail = "pj267443@gmail.com";

function login(){
 auth.signInWithEmailAndPassword(
   document.getElementById("email").value,
   document.getElementById("password").value
 ).then(res=>{
  document.getElementById('loginCard').style.display='none';
  document.getElementById('app').style.display='block';

  if(res.user.email===boyfriendEmail){
    document.getElementById('boyfriendPanel').style.display='block';
    loadComplaints();
    loadHugs();
  } else {
    document.getElementById('girlfriendPanel').style.display='block';
  }

  loadStatus();
 })
 .catch(()=>alert("Login error ğŸ˜¢"));
}

function submitComplaint(){
 db.collection('complaints').add({
  text:complaint.value,
  category:category.value,
  status:'Pending',
  time:new Date()
 })
 complaint.value='';
}

function loadComplaints(){
 db.collection('complaints').orderBy('time','desc')
 .onSnapshot(snap=>{
  complaints.innerHTML='';
  snap.forEach(doc=>{
    let c=doc.data();
    complaints.innerHTML+=`
    <p>
    <b>${c.category}</b>: ${c.text}
    <br>Status: ${c.status}
    <br><button onclick="resolve('${doc.id}')">Resolve â¤ï¸</button>
    </p>`
  })
 })
}

function resolve(id){
 db.collection('complaints').doc(id).update({
   status:'Resolved â¤ï¸'
 })
 heartAnimation();
}

function heartAnimation(){
 let heart=document.createElement('div');
 heart.className='heart';
 heart.innerHTML='â¤ï¸';
 heart.style.left=Math.random()*window.innerWidth+'px';
 document.body.appendChild(heart);
 setTimeout(()=>heart.remove(),2000);
}

function giveHug(){
 db.collection('meta').doc('hugs').set({
   count: firebase.firestore.FieldValue.increment(1)
 }, {merge:true})
}

function loadHugs(){
 db.collection('meta').doc('hugs')
 .onSnapshot(doc=>{
  if(doc.exists){
    document.getElementById('hugCount').innerText=doc.data().count;
  }
 })
}

function loadStatus(){
 db.collection('complaints').orderBy('time','desc')
 .onSnapshot(snap=>{
  status.innerHTML='';
  snap.forEach(doc=>{
    let c=doc.data();
    status.innerHTML+=`<p>${c.category} â€” <b>${c.status}</b></p>`
  })
 })
}

function uploadVoice(){
 alert("Voice reply ready â¤ï¸ (Firebase Storage connect karenge next step me)");
}
</script>

</body>
</html>